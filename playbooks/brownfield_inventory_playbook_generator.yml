---
# ===================================================================================================
# BROWNFIELD INVENTORY PLAYBOOK GENERATOR - KEY SCENARIOS
# ===================================================================================================
#
# This playbook demonstrates key scenarios for generating YAML configurations
# for the inventory_workflow_manager module based on existing device inventory in
# Cisco Catalyst Center.
#
# KEY FEATURES:
# 1. Three Independent Components: device_details, provision_device, interface_details
# 2. Global Filters: ip_address_list applies to ALL components
# 3. Component-Specific Filters: Independent filtering for each component
# 4. Three-Document Output: Separate YAML documents for each component
# 5. HTTP Fields Support: http_username, http_password, http_port, http_secure
# 6. Smart File Creation: No file created if no data matches filters
#
# ===================================================================================================

- name: Cisco Catalyst Center Brownfield Inventory Playbook Generator - Key Scenarios
  hosts: localhost
  connection: local
  gather_facts: false
  vars_files:
    - "credentials.yml"

  tasks:
    # ===================================================================================
    # SCENARIO 1: Complete Discovery - All Components
    # ===================================================================================
    # Description: Auto-discovers ALL devices and generates all three components
    # Use Case: Initial brownfield migration, complete infrastructure backup
    # Output: Single YAML with 3 documents (device details, provision, interfaces)
    # ===================================================================================
    - name: "SCENARIO 1: Complete Discovery - All Components"
      cisco.dnac.brownfield_inventory_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: INFO
        state: gathered
        config:
          - generate_all_configurations: true
            file_path: "inventory_all_devices_complete.yml"
      tags: [scenario1, complete_discovery]

    # ===================================================================================
    # SCENARIO 2: Specific IPs - All Three Components
    # ===================================================================================
    # Description: Generate all three components for specific IP addresses
    # Use Case: Targeted device migration with full configuration
    # Output: 3 documents for specified IPs
    # ===================================================================================
    - name: "SCENARIO 2: Specific IPs - All Three Components"
      cisco.dnac.brownfield_inventory_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: INFO
        state: gathered
        config:
          - file_path: "inventory_specific_ips.yml"
            global_filters:
              ip_address_list:
                - "172.27.248.223"
                - "204.1.2.3"
                - "205.1.2.67"
            component_specific_filters:
              components_list: ["device_details", "provision_device", "interface_details"]
      tags: [scenario2, specific_ips]

    # ===================================================================================
    # SCENARIO 3: Device Details Only
    # ===================================================================================
    # Description: Generate only device details component (credentials and basic info)
    # Use Case: Device inventory only, no provisioning or interface changes
    # Output: Single document with device credentials
    # ===================================================================================
    - name: "SCENARIO 3: Device Details Only"
      cisco.dnac.brownfield_inventory_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: INFO
        state: gathered
        config:
          - file_path: "inventory_device_details_only.yml"
            global_filters:
              ip_address_list:
                - "172.27.248.223"
                - "204.1.2.2"
            component_specific_filters:
              components_list: ["device_details"]
      tags: [scenario3, device_details_only]

    # ===================================================================================
    # SCENARIO 4: Provision Device Only - Site Filter
    # ===================================================================================
    # Description: Generate only provision config for devices at a specific site
    # Use Case: Site-specific provisioning without modifying device credentials
    # Output: Single document with provision config
    # ===================================================================================
    - name: "SCENARIO 4: Provision Device Only - Site Filter"
      cisco.dnac.brownfield_inventory_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: INFO
        state: gathered
        config:
          - file_path: "inventory_provision_only.yml"
            component_specific_filters:
              components_list: ["provision_device"]
              provision_device:
                site_name: "Global/Site_India/Karnataka/Bangalore/BLD_2/Floor_1"
      tags: [scenario4, provision_only]

    # ===================================================================================
    # SCENARIO 5: Interface Details Only
    # ===================================================================================
    # Description: Generate only interface details for specific devices
    # Use Case: Interface audit, VLAN configuration review
    # Output: Single document with interface configurations
    # ===================================================================================
    - name: "SCENARIO 5: Interface Details Only"
      cisco.dnac.brownfield_inventory_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: INFO
        state: gathered
        config:
          - file_path: "inventory_interface_only.yml"
            global_filters:
              ip_address_list:
                - "205.1.2.67"
                - "205.1.2.68"
            component_specific_filters:
              components_list: ["interface_details"]
      tags: [scenario5, interface_only]

    # ===================================================================================
    # SCENARIO 6: Independent Component Filters
    # ===================================================================================
    # Description: Demonstrates INDEPENDENT filtering for different components:
    #              - device_details: Only ACCESS role devices
    #              - provision_device: Only specific site (independent of role filter)
    #              - interface_details: All devices from global filter
    # Use Case: Show that each component filters independently
    # Output: 3 documents with different device sets based on independent filters
    # ===================================================================================
    - name: "SCENARIO 6: Independent Component Filters"
      cisco.dnac.brownfield_inventory_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: INFO
        state: gathered
        config:
          - file_path: "inventory_independent_filters.yml"
            component_specific_filters:
              components_list: ["device_details", "provision_device", "interface_details"]
              device_details:
                role: "ACCESS"
              provision_device:
                site_name: "Global/Site_India/Karnataka/Bangalore/BLD_2/Floor_1"
      tags: [scenario6, independent_filters]

    # ===================================================================================
    # SCENARIO 7: Global Filter + Component-Specific Filters
    # ===================================================================================
    # Description: Global IP filter applies to ALL components, then provision filter applied
    # Use Case: Target specific devices, then filter provision by site
    # Output: 3 documents, all using same global IPs, provision filtered by site
    # ===================================================================================
    - name: "SCENARIO 7: Global + Component-Specific Filters"
      cisco.dnac.brownfield_inventory_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: INFO
        state: gathered
        config:
          - file_path: "inventory_global_component_filters.yml"
            global_filters:
              ip_address_list:
                - "172.27.248.223"
                - "172.27.248.224"
                - "205.1.2.67"
            component_specific_filters:
              components_list: ["device_details", "provision_device", "interface_details"]
              provision_device:
                site_name: "Global/Site_India/Karnataka/Bangalore/BLD_2/Floor_1"
      tags: [scenario7, global_component]

    # ===================================================================================
    # SCENARIO 8: Role Filter - ACCESS Devices
    # ===================================================================================
    # Description: Generate device details for ACCESS role devices only
    # Use Case: Access layer device inventory
    # Output: Single document with ACCESS role devices
    # ===================================================================================
    - name: "SCENARIO 8: ACCESS Role Devices"
      cisco.dnac.brownfield_inventory_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: INFO
        state: gathered
        config:
          - file_path: "inventory_access_role.yml"
            component_specific_filters:
              components_list: ["device_details"]
              device_details:
                role: "ACCESS"
      tags: [scenario8, access_role]

    # ===================================================================================
    # SCENARIO 9: Multiple Roles - OR Logic
    # ===================================================================================
    # Description: Generate device details for multiple roles (ACCESS OR BORDER ROUTER)
    # Use Case: Combined access and border device inventory
    # Output: Single document with devices matching ANY of the specified roles
    # ===================================================================================
    - name: "SCENARIO 9: Multiple Roles - OR Logic"
      cisco.dnac.brownfield_inventory_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: INFO
        state: gathered
        config:
          - file_path: "inventory_multi_role.yml"
            component_specific_filters:
              components_list: ["device_details"]
              device_details:
                role: ["ACCESS", "BORDER ROUTER", "CORE"]
      tags: [scenario9, multi_role]

    # ===================================================================================
    # SCENARIO 10: Device Details + Provision
    # ===================================================================================
    # Description: Generate device details and provision, skip interface details
    # Use Case: Device onboarding without interface changes
    # Output: 2 documents - device details and provision
    # ===================================================================================
    - name: "SCENARIO 10: Device Details + Provision"
      cisco.dnac.brownfield_inventory_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: INFO
        state: gathered
        config:
          - file_path: "inventory_device_provision.yml"
            global_filters:
              ip_address_list:
                - "172.27.248.223"
            component_specific_filters:
              components_list: ["device_details", "provision_device"]
      tags: [scenario10, device_provision]

    # ===================================================================================
    # SCENARIO 11: Multiple Sites - Independent Files
    # ===================================================================================
    # Description: Generate multiple files for different sites
    # Use Case: Multi-site deployment with site-specific configs
    # Output: Multiple YAML files, each with different site provision configs
    # ===================================================================================
    - name: "SCENARIO 11: Multiple Sites - Independent Files"
      cisco.dnac.brownfield_inventory_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: INFO
        state: gathered
        config:
          # Site 1: Bangalore BLD_1
          - file_path: "inventory_site_bangalore_bld1.yml"
            component_specific_filters:
              components_list: ["provision_device"]
              provision_device:
                site_name: "Global/Site_India/Karnataka/Bangalore/BLD_1/Floor_1"
          # Site 2: Bangalore BLD_2
          - file_path: "inventory_site_bangalore_bld2.yml"
            component_specific_filters:
              components_list: ["provision_device"]
              provision_device:
                site_name: "Global/Site_India/Karnataka/Bangalore/BLD_2/Floor_1"
      tags: [scenario11, multi_site]

    # ===================================================================================
    # SCENARIO 12: Default File Path - Auto-Generated Name
    # ===================================================================================
    # Description: No file_path specified - generates with timestamp
    # Use Case: Quick discovery without worrying about naming
    # Output: File named inventory_workflow_manager_playbook_<timestamp>.yml
    # ===================================================================================
    - name: "SCENARIO 12: Default File Path (Auto-Generated)"
      cisco.dnac.brownfield_inventory_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: INFO
        state: gathered
        config:
          - global_filters:
              ip_address_list:
                - "172.27.248.223"
            component_specific_filters:
              components_list: ["device_details"]
      tags: [scenario12, default_path]

    # ===================================================================================
    # SCENARIO 13: Interface Details with Single Interface Name Filter
    # ===================================================================================
    # Description: Filter interface_details to include only specific interface names
    # Use Case: Focus on specific VLAN or Loopback interface configuration
    # Output: Single document with only specified interface names (e.g., Vlan100)
    # ===================================================================================
    - name: "SCENARIO 13: Interface Details - Single Interface Filter (Vlan100)"
      cisco.dnac.brownfield_inventory_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: INFO
        state: gathered
        config:
          - file_path: "inventory_interface_vlan100_only.yml"
            component_specific_filters:
              components_list: ["interface_details"]
              interface_details:
                interface_name: ["Vlan100"]
      tags: [scenario13, interface_single_filter]

    # ===================================================================================
    # SCENARIO 14: Interface Details with Multiple Interface Name Filters
    # ===================================================================================
    # Description: Filter interface_details to include multiple specific interface names
    # Use Case: Audit and configure multiple critical interfaces across all devices
    # Output: Single document with only specified interface names (Vlan100, Loopback0, etc.)
    # ===================================================================================
    - name: "SCENARIO 14: Interface Details - Multiple Interface Filters"
      cisco.dnac.brownfield_inventory_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: INFO
        state: gathered
        config:
          - file_path: "inventory_interface_multi_filter.yml"
            component_specific_filters:
              components_list: ["interface_details"]
              interface_details:
                interface_name: ["Vlan100", "Vlan111", "Loopback0"]
      tags: [scenario14, interface_multi_filter]

    # ===================================================================================
    # SCENARIO 15: Global IP Filter + Interface Name Filter
    # ===================================================================================
    # Description: Combine global IP filter with specific interface name filter
    # Use Case: Get specific interfaces only from targeted devices
    # Output: Single document with only specified IPs and specified interfaces
    # Note: If device doesn't have the specified interface, no config generated for it
    # ===================================================================================
    - name: "SCENARIO 15: Global IP + Interface Name Filter"
      cisco.dnac.brownfield_inventory_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: INFO
        state: gathered
        config:
          - file_path: "inventory_ip_interface_filter.yml"
            global_filters:
              ip_address_list:
                - "100.1.1.61"
                - "172.27.248.223"
                - "205.1.2.67"
            component_specific_filters:
              components_list: ["interface_details"]
              interface_details:
                interface_name: ["Vlan100", "Loopback0", "GigabitEthernet0/0"]
      tags: [scenario15, ip_interface_filter]

    # ===================================================================================
    # SCENARIO 16: Device Details + Interface Details with Interface Filter
    # ===================================================================================
    # Description: Generate device credentials and only specific interfaces
    # Use Case: Onboard devices and configure specific interfaces simultaneously
    # Output: 2 documents - device details and filtered interface configs
    # ===================================================================================
    - name: "SCENARIO 16: Device Details + Filtered Interfaces"
      cisco.dnac.brownfield_inventory_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: INFO
        state: gathered
        config:
          - file_path: "inventory_device_filtered_interfaces.yml"
            global_filters:
              ip_address_list:
                - "172.27.248.223"
                - "205.1.2.67"
            component_specific_filters:
              components_list: ["device_details", "interface_details"]
              interface_details:
                interface_name: ["Loopback0", "Vlan100"]
      tags: [scenario16, device_filtered_interface]

    # ===================================================================================
    # SCENARIO 17: All Components with Interface Filter
    # ===================================================================================
    # Description: Generate all three components with interface_details filtered by name
    # Use Case: Complete infrastructure migration with controlled interface updates
    # Output: 3 documents - device details, provision config, and filtered interfaces
    # ===================================================================================
    - name: "SCENARIO 17: All Components - Device + Provision + Filtered Interfaces"
      cisco.dnac.brownfield_inventory_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: INFO
        state: gathered
        config:
          - file_path: "inventory_all_filtered_interfaces.yml"
            global_filters:
              ip_address_list:
                - "172.27.248.223"
                - "205.1.2.67"
            component_specific_filters:
              components_list: ["device_details", "provision_device", "interface_details"]
              provision_device:
                site_name: "Global/Site_India/Karnataka/Bangalore/BLD_2/Floor_1"
              interface_details:
                interface_name: ["Loopback0"]
      tags: [scenario17, all_components_filtered]

    # ===================================================================================
    # SCENARIO 18: Interface Filter with No Matching Interfaces
    # ===================================================================================
    # Description: Filter interfaces that may not exist on all devices
    # Use Case: Handle scenarios where some devices don't have specified interfaces
    # Output: Only generates configs for devices that have the specified interfaces
    # Note: No file created if no devices have matching interfaces
    # ===================================================================================
    - name: "SCENARIO 18: Interface Filter - No Match Handling"
      cisco.dnac.brownfield_inventory_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: INFO
        state: gathered
        config:
          - file_path: "inventory_interface_no_match.yml"
            global_filters:
              ip_address_list:
                - "172.27.248.223"
                - "172.27.248.224"
                - "172.27.248.82"
            component_specific_filters:
              components_list: ["interface_details"]
              interface_details:
                interface_name: ["TenGigabitEthernet1/1/1"]  # Might not exist on all devices
      tags: [scenario18, interface_no_match]

    # ===================================================================================
    # SCENARIO 19: GigabitEthernet Interface Filter
    # ===================================================================================
    # Description: Filter for physical GigabitEthernet interfaces only
    # Use Case: Configure access ports or uplinks specifically
    # Output: Single document with GigabitEthernet interface configs only
    # ===================================================================================
    - name: "SCENARIO 19: GigabitEthernet Interfaces Only"
      cisco.dnac.brownfield_inventory_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: INFO
        state: gathered
        config:
          - file_path: "inventory_gigabitethernet_only.yml"
            component_specific_filters:
              components_list: ["interface_details"]
              interface_details:
                interface_name: ["GigabitEthernet0/0", "GigabitEthernet1/0/11", "GigabitEthernet1/0/12"]
      tags: [scenario19, gigabitethernet_only]

    # ===================================================================================
    # SCENARIO 20: Role-Based Devices with Interface Filter
    # ===================================================================================
    # Description: Get ACCESS role devices and filter their specific interfaces
    # Use Case: Configure access layer devices with specific interface updates
    # Output: 2 documents - filtered device details (ACCESS only) and their interfaces
    # ===================================================================================
    - name: "SCENARIO 20: ACCESS Devices with Specific Interface Filter"
      cisco.dnac.brownfield_inventory_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: INFO
        state: gathered
        config:
          - file_path: "inventory_access_devices_interface_filter.yml"
            component_specific_filters:
              components_list: ["device_details", "interface_details"]
              device_details:
                role: "ACCESS"
              interface_details:
                interface_name: ["GigabitEthernet0/0", "GigabitEthernet0/1"]
      tags: [scenario20, access_devices_interface]

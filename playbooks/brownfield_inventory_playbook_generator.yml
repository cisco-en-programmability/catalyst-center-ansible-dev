---
# ===================================================================================================
# BROWNFIELD INVENTORY PLAYBOOK GENERATOR - KEY SCENARIOS
# ===================================================================================================
#
# This playbook demonstrates key scenarios for generating YAML configurations
# for the inventory_workflow_manager module based on existing device inventory in
# Cisco Catalyst Center.
#
# KEY FEATURES:
# 1. Three Independent Components: device_details, provision_device, interface_details
# 2. Global Filters: ip_address_list applies to ALL components
# 3. Component-Specific Filters: Independent filtering for each component
# 4. Three-Document Output: Separate YAML documents for each component
# 5. HTTP Fields Support: http_username, http_password, http_port, http_secure
# 6. Smart File Creation: No file created if no data matches filters
#
# ===================================================================================================

- name: Cisco Catalyst Center Brownfield Inventory Playbook Generator - Key Scenarios
  hosts: localhost
  connection: local
  gather_facts: false
  vars_files:
    - "credentials.yml"

  tasks:
    # ===================================================================================
    # SCENARIO 1: Complete Discovery - All Components
    # ===================================================================================
    # Description: Auto-discovers ALL devices and generates all three components
    # Use Case: Initial brownfield migration, complete infrastructure backup
    # Output: Single YAML with 3 documents (device details, provision, interfaces)
    # ===================================================================================
    - name: "SCENARIO 1: Complete Discovery - All Components"
      cisco.dnac.brownfield_inventory_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: INFO
        state: gathered
        config:
          - generate_all_configurations: true
            file_path: "inventory_all_devices_complete.yml"
      tags: [scenario1, complete_discovery]

    # ===================================================================================
    # SCENARIO 2: Specific IPs - All Three Components
    # ===================================================================================
    # Description: Generate all three components for specific IP addresses
    # Use Case: Targeted device migration with full configuration
    # Output: 3 documents for specified IPs
    # ===================================================================================
    - name: "SCENARIO 2: Specific IPs - All Three Components"
      cisco.dnac.brownfield_inventory_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: INFO
        state: gathered
        config:
          - file_path: "inventory_specific_ips.yml"
            global_filters:
              ip_address_list:
                - "172.27.248.223"
                - "204.1.2.3"
                - "205.1.2.67"
            component_specific_filters:
              components_list: ["device_details", "provision_device", "interface_details"]
      tags: [scenario2, specific_ips]

    # ===================================================================================
    # SCENARIO 3: Device Details Only
    # ===================================================================================
    # Description: Generate only device details component (credentials and basic info)
    # Use Case: Device inventory only, no provisioning or interface changes
    # Output: Single document with device credentials
    # ===================================================================================
    - name: "SCENARIO 3: Device Details Only"
      cisco.dnac.brownfield_inventory_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: INFO
        state: gathered
        config:
          - file_path: "inventory_device_details_only.yml"
            global_filters:
              ip_address_list:
                - "172.27.248.223"
                - "204.1.2.2"
            component_specific_filters:
              components_list: ["device_details"]
      tags: [scenario3, device_details_only]

    # ===================================================================================
    # SCENARIO 4: Provision Device Only - Site Filter
    # ===================================================================================
    # Description: Generate only provision config for devices at a specific site
    # Use Case: Site-specific provisioning without modifying device credentials
    # Output: Single document with provision config
    # ===================================================================================
    - name: "SCENARIO 4: Provision Device Only - Site Filter"
      cisco.dnac.brownfield_inventory_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: INFO
        state: gathered
        config:
          - file_path: "inventory_provision_only.yml"
            component_specific_filters:
              components_list: ["provision_device"]
              provision_device:
                site_name: "Global/Site_India/Karnataka/Bangalore/BLD_2/Floor_1"
      tags: [scenario4, provision_only]

    # ===================================================================================
    # SCENARIO 5: Interface Details Only
    # ===================================================================================
    # Description: Generate only interface details for specific devices
    # Use Case: Interface audit, VLAN configuration review
    # Output: Single document with interface configurations
    # ===================================================================================
    - name: "SCENARIO 5: Interface Details Only"
      cisco.dnac.brownfield_inventory_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: INFO
        state: gathered
        config:
          - file_path: "inventory_interface_only.yml"
            global_filters:
              ip_address_list:
                - "205.1.2.67"
                - "205.1.2.68"
            component_specific_filters:
              components_list: ["interface_details"]
      tags: [scenario5, interface_only]

    # ===================================================================================
    # SCENARIO 6: Independent Component Filters
    # ===================================================================================
    # Description: Demonstrates INDEPENDENT filtering for different components:
    #              - device_details: Only ACCESS role devices
    #              - provision_device: Only specific site (independent of role filter)
    #              - interface_details: All devices from global filter
    # Use Case: Show that each component filters independently
    # Output: 3 documents with different device sets based on independent filters
    # ===================================================================================
    - name: "SCENARIO 6: Independent Component Filters"
      cisco.dnac.brownfield_inventory_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: INFO
        state: gathered
        config:
          - file_path: "inventory_independent_filters.yml"
            component_specific_filters:
              components_list: ["device_details", "provision_device", "interface_details"]
              device_details:
                role: "ACCESS"
              provision_device:
                site_name: "Global/Site_India/Karnataka/Bangalore/BLD_2/Floor_1"
      tags: [scenario6, independent_filters]

    # ===================================================================================
    # SCENARIO 7: Global Filter + Component-Specific Filters
    # ===================================================================================
    # Description: Global IP filter applies to ALL components, then provision filter applied
    # Use Case: Target specific devices, then filter provision by site
    # Output: 3 documents, all using same global IPs, provision filtered by site
    # ===================================================================================
    - name: "SCENARIO 7: Global + Component-Specific Filters"
      cisco.dnac.brownfield_inventory_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: INFO
        state: gathered
        config:
          - file_path: "inventory_global_component_filters.yml"
            global_filters:
              ip_address_list:
                - "172.27.248.223"
                - "172.27.248.224"
                - "205.1.2.67"
            component_specific_filters:
              components_list: ["device_details", "provision_device", "interface_details"]
              provision_device:
                site_name: "Global/Site_India/Karnataka/Bangalore/BLD_2/Floor_1"
      tags: [scenario7, global_component]

    # ===================================================================================
    # SCENARIO 8: Role Filter - ACCESS Devices
    # ===================================================================================
    # Description: Generate device details for ACCESS role devices only
    # Use Case: Access layer device inventory
    # Output: Single document with ACCESS role devices
    # ===================================================================================
    - name: "SCENARIO 8: ACCESS Role Devices"
      cisco.dnac.brownfield_inventory_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: INFO
        state: gathered
        config:
          - file_path: "inventory_access_role.yml"
            component_specific_filters:
              components_list: ["device_details"]
              device_details:
                role: "ACCESS"
      tags: [scenario8, access_role]

    # ===================================================================================
    # SCENARIO 9: Multiple Roles - OR Logic
    # ===================================================================================
    # Description: Generate device details for multiple roles (ACCESS OR BORDER ROUTER)
    # Use Case: Combined access and border device inventory
    # Output: Single document with devices matching ANY of the specified roles
    # ===================================================================================
    - name: "SCENARIO 9: Multiple Roles - OR Logic"
      cisco.dnac.brownfield_inventory_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: INFO
        state: gathered
        config:
          - file_path: "inventory_multi_role.yml"
            component_specific_filters:
              components_list: ["device_details"]
              device_details:
                role: ["ACCESS", "BORDER ROUTER", "CORE"]
      tags: [scenario9, multi_role]

    # ===================================================================================
    # SCENARIO 10: Device Details + Provision
    # ===================================================================================
    # Description: Generate device details and provision, skip interface details
    # Use Case: Device onboarding without interface changes
    # Output: 2 documents - device details and provision
    # ===================================================================================
    - name: "SCENARIO 10: Device Details + Provision"
      cisco.dnac.brownfield_inventory_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: INFO
        state: gathered
        config:
          - file_path: "inventory_device_provision.yml"
            global_filters:
              ip_address_list:
                - "172.27.248.223"
            component_specific_filters:
              components_list: ["device_details", "provision_device"]
      tags: [scenario10, device_provision]

    # ===================================================================================
    # SCENARIO 11: Multiple Sites - Independent Files
    # ===================================================================================
    # Description: Generate multiple files for different sites
    # Use Case: Multi-site deployment with site-specific configs
    # Output: Multiple YAML files, each with different site provision configs
    # ===================================================================================
    - name: "SCENARIO 11: Multiple Sites - Independent Files"
      cisco.dnac.brownfield_inventory_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: INFO
        state: gathered
        config:
          # Site 1: Bangalore BLD_1
          - file_path: "inventory_site_bangalore_bld1.yml"
            component_specific_filters:
              components_list: ["provision_device"]
              provision_device:
                site_name: "Global/Site_India/Karnataka/Bangalore/BLD_1/Floor_1"
          # Site 2: Bangalore BLD_2
          - file_path: "inventory_site_bangalore_bld2.yml"
            component_specific_filters:
              components_list: ["provision_device"]
              provision_device:
                site_name: "Global/Site_India/Karnataka/Bangalore/BLD_2/Floor_1"
      tags: [scenario11, multi_site]

    # ===================================================================================
    # SCENARIO 12: Default File Path - Auto-Generated Name
    # ===================================================================================
    # Description: No file_path specified - generates with timestamp
    # Use Case: Quick discovery without worrying about naming
    # Output: File named inventory_workflow_manager_playbook_<timestamp>.yml
    # ===================================================================================
    - name: "SCENARIO 12: Default File Path (Auto-Generated)"
      cisco.dnac.brownfield_inventory_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: INFO
        state: gathered
        config:
          - global_filters:
              ip_address_list:
                - "172.27.248.223"
            component_specific_filters:
              components_list: ["device_details"]
      tags: [scenario12, default_path]
